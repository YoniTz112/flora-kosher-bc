<!DOCTYPE html>
<html lang="he">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>×ª×¤×¨×™×˜ ×”××¡×¢×“×”</title>

<style>
/* CSS ORIGINAL MANTIDO */
body {
  font-family: 'David Libre', Arial, sans-serif;
  background: #fffaf0;
  direction: rtl;
  margin: 0;
  padding: 0;
  color: #333;
}

header {
  background-color: #1e90ff;
  color: white;
  padding: 20px;
  text-align: center;
  font-size: 2em;
  font-weight: bold;
  box-shadow: 0 2px 6px rgba(0,0,0,0.2);
}

.container {
  padding: 20px;
  max-width: 600px;
  margin: auto;
  padding-bottom: 120px;
}

h2 {
  color: #1e90ff;
  margin-top: 25px;
  border-bottom: 2px solid #1e90ff;
  padding-bottom: 5px;
}

.item, .drink-container {
  margin-bottom: 15px;
  border-radius: 10px;
  background: #fff;
  padding: 10px 15px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  position: relative;
  z-index: 1;
}

.item label, .drink-container label {
  font-size: 1.3em;
  color: #00bfff;
  font-weight: bold;
}

.item button, .drink-container button {
  position: relative; /* NecessÃ¡rio para o z-index funcionar */
  z-index: 9999 !important; /* Fica acima de quase tudo */
  cursor: pointer;
  touch-action: manipulation; /* Remove o delay do clique no mobile */
}

button {
  background-color: #ffcc00;
  border: none;
  padding: 12px 20px;
  font-size: 1.2em;
  cursor: pointer;
  margin-top: 10px;
  border-radius: 10px;
  transition: 0.3s;
  font-weight: bold;
  position: relative; 
  z-index: 10;
  touch-action: manipulation; /* Otimiza o clique para mobile, removendo o delay de 300ms */
  -webkit-tap-highlight-color: transparent; /* Remove aquele quadrado cinza ao clicar */
}

button:hover {
  background-color: #e6b800;
}

/* Toppings */
.toppings {
  margin-top: 5px;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.toppings label {
  display: flex;
  align-items: center;
  gap: 8px;
}

.toppings input[type="checkbox"] {
  appearance: none;
  -webkit-appearance: none;
  width: 20px;
  height: 20px;
  border: 2px solid #1e90ff;
  border-radius: 4px;
  cursor: pointer;
  display: flex;
  justify-content: center;
  align-items: center;
}

.toppings input[type="checkbox"]:checked {
  background-color: #1e90ff;
  color: white;
}

.toppings input[type="checkbox"]:checked::after {
  content: "âœ”";
  font-size: 14px;
}

/* Cart Styles */
#cartToggle {
  position: fixed;
  bottom: 20px; /* Mudado para baixo para nÃ£o bater nos botÃµes laterais */
  left: 10px;
  border-radius: 50px;
  background-color: #ff6600;
  color: white;
  padding: 15px;
  cursor: pointer;
  z-index: 1000;
  font-weight: bold;
  box-shadow: 0 4px 10px rgba(0,0,0,0.3);
}

.cart {
  background-color: #f8f1d1;
  padding: 10px;
  font-weight: bold;
  position: fixed;
  top: 0;
  left: -350px; /* Esconde totalmente */
  width: 300px;
  height: 100%;
  box-shadow: 2px 0 10px rgba(0,0,0,0.2);
  transition: left 0.3s ease;
  z-index: 2000;
  display: flex;
  flex-direction: column;
}

.cart.open {
  left: 0;
}

.cart-content {
  flex-grow: 1;
  overflow-y: auto;
}

.cart-footer {
padding-top: 10px;
  border-top: 1px solid #ccc;
  background-color: #f8f1d1;
}

.cart-item {
  display: flex;
  align-items: center;
  justify-content: flex-start;
  gap: 5px;
}

.cart-item button {
  background-color: red;
  color: white;
  padding: 0 5px;
  font-size: 0.9em;
  border-radius: 3px;
  cursor: pointer;
}

/* Order message */
#orderMessage {
  display:none;
  position:fixed;
  top:0;
  left:0;
  width:100%;
  height:100%;
  background:rgba(0,0,0,0.8);
  color:white;
  justify-content:center;
  align-items:center;
  font-size:2em;
  text-align:center;
  z-index:300;
  padding:20px;
  box-sizing:border-box;
  flex-direction:column;
}
#orderMessage button {
  margin-top:20px;
  padding:10px 20px;
  font-size:1em;
  cursor:pointer;
  background:#ffcc00;
  border:none;
  border-radius:5px;
  color:#000;
}

.added-popup {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: #4caf50;
  color: white;
  padding: 20px 30px;
  border-radius: 15px;
  font-size: 1.6em;
  font-weight: bold;
  box-shadow: 0 4px 20px rgba(0,0,0,0.3);
  opacity: 0;
  transition: opacity 0.3s ease;
  z-index: 500;
}

.added-popup.show {
  opacity: 1;
}

.input-label {
  display: block;
  font-weight: bold;
  margin-top: 20px;
  margin-bottom: 8px;
  font-size: 1.5em;
  color: #1e90ff;
}

.styled-input {
  width: 100%;
  padding: 12px 15px;
  font-size: 1.2em;
  border-radius: 10px;
  border: 2px solid #ccc;
  box-sizing: border-box;
}

.styled-input:focus {
  border-color: #1e90ff;
  box-shadow: 0 0 12px rgba(30,144,255,0.5);
  outline: none;
}

.latin-warning {
  color: red;
  font-weight: bold;
  font-size: 0.95em;
  margin-top: 5px;
  display: block;
}

.latin-only {
  direction: ltr;
}
</style>
</head>

<body>

  <div id="addedPopup" class="added-popup">× ×•×¡×£ ×œ×¢×’×œ×” âœ”</div>

<header>×ª×¤×¨×™×˜ ×”××˜×‘×— ×”×™×©×¨××œ×™ ×‘×™×ª ×—×‘×´×“ ×¤×œ×•×¨×”</header>

<div class="container">

<label for="customerName" class="input-label">×©×:</label>
<input type="text" id="customerName" placeholder="×©×:" required class="styled-input latin-only">
<small class="latin-warning">
 ×™×© ×œ××œ× ××ª ×”×©× ×‘××•×ª×™×•×ª ×× ×’×œ×™×•×ª ×‘×œ×‘×“ 
</small>

<label for="customerSurname" class="input-label">×©× ××©×¤×—×”:</label>
<input type="text" id="customerSurname" placeholder="×©× ××©×¤×—×”:" required class="styled-input latin-only">
<small class="latin-warning">
 ×™×© ×œ××œ× ××ª ×©× ×”××©×¤×—×” ×‘××•×ª×™×•×ª ×× ×’×œ×™×•×ª ×‘×œ×‘×“
</small>


<div id="shabatButtonContainer" style="display:none;">
  <div class="item" style="background: #eef7ff; border: 2px solid #1e90ff; text-align: center; margin-top: 15px;">
    <button onclick="window.location.href='/shabat.html'" style="width: 100%; background-color: #1e90ff; color: white; border: none; margin-top: 5px;">
      ×§× ×™×•×ª ×œ×©×‘×ª ×§×•×“×©
    </button>
  </div>
</div>


<h2>×× ×•×ª ×¢×™×§×¨×™×•×ª</h2>

<script>
async function checkShabat(){
  const shabatBtn = document.getElementById("shabatButtonContainer");
  try {
    const res = await fetch("/shabat-status");
    const data = await res.json();
    if(data.active){
      shabatBtn.style.display = "block";
    } else {
      shabatBtn.style.display = "none";
    }
  } catch(err) {
    console.error("Erro ao buscar status do Shabat:", err);
  }
}

window.onload = function() {
  checkShabat();
  const savedItems = localStorage.getItem('tempCart');
  if (savedItems) {
    const newItems = JSON.parse(savedItems);
    cart = [...cart, ...newItems];
    localStorage.removeItem('tempCart');
    updateCart();
  }
};
</script>

<div class="item">
  <label>×©× ×™×¦×œ ×‘×‘×’×˜ â€“ â‚ª60</label>
  <div class="toppings">
    <label>×ª×•×¡×¤×•×ª:</label>
    <label><input type="checkbox" class="topping" data-name="×—×•××•×¡" data-price="0"> ×—×•××•×¡</label>
    <label><input type="checkbox" class="topping" data-name="×—×¨×™×£" data-price="0"> ×—×¨×™×£</label>
    <label><input type="checkbox" class="topping" data-name="×¡×œ×˜ ×™×©×¨××œ×™" data-price="0"> ×¡×œ×˜ ×™×©×¨××œ×™</label>
    <label><input type="checkbox" class="topping" data-name="×›×¨×•×‘ ×œ×‘×Ÿ" data-price="0"> ×›×¨×•×‘ ×œ×‘×Ÿ</label>
    <label><input type="checkbox" class="topping" data-name="×›×¨×•×‘ ×¡×’×•×œ" data-price="0"> ×›×¨×•×‘ ×¡×’×•×œ</label>
    <label><input type="checkbox" class="topping" data-name="×—×¨×™×£ ×‘×¦×“" data-price="0"> ×—×¨×™×£ ×‘×¦×“</label>
    <label><input type="checkbox" class="topping" data-name="×¨×•×˜×‘ ×¦'×™×¤×•×˜×œ×” ×‘×¦×“" data-price="1"> ×¨×•×˜×‘ ×¦'×™×¤×•×˜×œ×” ×‘×¦×“ (30 ×’×¨×) (+â‚ª1)</label>
    <label><input type="checkbox" class="topping" data-name="×¦â€™×™×¤×¡ ×‘×¦×“" data-price="8"> ×¦â€™×™×¤×¡ ×‘×¦×“ (+â‚ª8)</label>
  </div>
  <button onclick="addToCart(this, 60, '×©× ×™×¦×œ ×‘×‘×’×˜')">×”×•×¡×£ ×œ×¢×’×œ×”</button>
  <p style="color:red; font-weight:bold; margin-top:5px;">××œ ×ª×©×›×—/×™ ×œ×”×•×¡×™×£ ×œ×¢×’×œ×”</p>
</div>

<div class="item">
  <label>×©×•×•××¨××” ×‘×‘×’×˜ â€“ â‚ª60</label>
  <div class="toppings">
    <label>×ª×•×¡×¤×•×ª:</label>
    <label><input type="checkbox" class="topping" data-name="×—×•××•×¡" data-price="0"> ×—×•××•×¡</label>
        <label><input type="checkbox" class="topping" data-name="×—×¨×™×£" data-price="0"> ×—×¨×™×£</label>
    <label><input type="checkbox" class="topping" data-name="×¡×œ×˜ ×™×©×¨××œ×™" data-price="0"> ×¡×œ×˜ ×™×©×¨××œ×™</label>
    <label><input type="checkbox" class="topping" data-name="×›×¨×•×‘ ×œ×‘×Ÿ" data-price="0"> ×›×¨×•×‘ ×œ×‘×Ÿ</label>
    <label><input type="checkbox" class="topping" data-name="×›×¨×•×‘ ×¡×’×•×œ" data-price="0"> ×›×¨×•×‘ ×¡×’×•×œ</label>
    <label><input type="checkbox" class="topping" data-name="×—×¨×™×£ ×‘×¦×“" data-price="0"> ×—×¨×™×£ ×‘×¦×“</label>
    <label><input type="checkbox" class="topping" data-name="×¨×•×˜×‘ ×¦'×™×¤×•×˜×œ×” ×‘×¦×“" data-price="1"> ×¨×•×˜×‘ ×¦'×™×¤×•×˜×œ×” ×‘×¦×“ (30 ×’×¨×) (+â‚ª1)</label>
    <label><input type="checkbox" class="topping" data-name="×¦â€™×™×¤×¡ ×‘×¦×“" data-price="8"> ×¦â€™×™×¤×¡ ×‘×¦×“ (+â‚ª8)</label>
  </div>
  <button onclick="addToCart(this, 60, '×©×•×•××¨××” ×‘×‘×’×˜')">×”×•×¡×£ ×œ×¢×’×œ×”</button>
  <p style="color:red; font-weight:bold; margin-top:5px;">××œ ×ª×©×›×—/×™ ×œ×”×•×¡×™×£ ×œ×¢×’×œ×”</p>
</div>

<div class="item">
  <label>×”××‘×•×¨×’×¨ â€“ â‚ª50</label>
  <div class="toppings">
    <label>×ª×•×¡×¤×•×ª:</label>
    <label><input type="checkbox" class="topping" data-name="×¢×’×‘× ×™×”"> ×¢×’×‘× ×™×”</label>
    <label><input type="checkbox" class="topping" data-name="×‘×¦×œ"> ×‘×¦×œ</label>
    <label><input type="checkbox" class="topping" data-name="×—×¡×”"> ×—×¡×”</label>
    <label><input type="checkbox" class="topping" data-name="×¨×•×˜×‘ ××œ×£ ×”××™×™×" data-price="1"> ×¨×•×˜×‘ ××œ×£ ×”××™×™× (2 ×©×§×™×•×ª) <br> (+â‚ª1)</label>
    <label><input type="checkbox" class="topping" data-name="×¨×•×˜×‘ ×¦'×™×¤×•×˜×œ×” ×‘×¦×“" data-price="2"> ×¨×•×˜×‘ ×¦'×™×¤×•×˜×œ×” ×‘×¦×“ (30 ×’×¨×) (+â‚ª1)</label>
    <label><input type="checkbox" class="topping" data-name="×¦â€™×™×¤×¡ ×‘×¦×“" data-price="8"> ×¦â€™×™×¤×¡ ×‘×¦×“ (+â‚ª8)</label>
    <label><input type="checkbox" class="topping" data-name="×ª×•×¡×¤×ª ×§×¦×™×¦×”" data-price="10"> ×ª×•×¡×¤×ª ×§×¦×™×¦×” (100 ×’×¨×) <br> (+â‚ª10)</label>
  </div>
  <button onclick="addToCart(this, 50, '×”××‘×•×¨×’×¨')">×”×•×¡×£ ×œ×¢×’×œ×”</button>
  <p style="color:red; font-weight:bold; margin-top:5px;">××œ ×ª×©×›×—/×™ ×œ×”×•×¡×™×£ ×œ×¢×’×œ×”</p>
</div>

<h2>×× ×ª ×¦â€™×™×¤×¡ â€“ â‚ª8</h2>
<div class="drink-container">
  <label>×¦â€™×™×¤×¡</label>
  <div class="qty-control">
    <button onclick="changeQty(this, -1)">-</button>
    <span>0</span>
    <button onclick="changeQty(this, 1)">+</button>
  </div>
  <button onclick="addQtyToCart('×¦â€™×™×¤×¡', 8, this)">×”×•×¡×£ ×œ×¢×’×œ×”</button>
  <p style="color:red; font-weight:bold; margin-top:5px;">××œ ×ª×©×›×—/×™ ×œ×”×•×¡×™×£ ×œ×¢×’×œ×”</p>
</div>

<h2>×©×ª×™×™×”</h2>

<div class="drink-container" dir="rtl">
  <label>×§×•×§×” ×§×•×œ×” 1.5 ×œ×™×˜×¨ - â‚ª14</label>
  <div class="qty-control">
    <button onclick="changeQty(this, -1)">-</button>
    <span>0</span>
    <button onclick="changeQty(this, 1)">+</button>
  </div>
  <button onclick="addQtyToCart('×§×•×§×” ×§×•×œ×” 1.5 ×œ×™×˜×¨', 14, this)">×”×•×¡×£ ×œ×¢×’×œ×”</button>
  <p style="color:red; font-weight:bold; margin-top:5px;">××œ ×ª×©×›×—/×™ ×œ×”×•×¡×™×£ ×œ×¢×’×œ×”</p>
</div>

<div class="drink-container" dir="rtl">
  <label>×§×•×œ×” ×–×™×¨×• 1.5 ×œ×™×˜×¨ - â‚ª14</label>
  <div class="qty-control">
    <button onclick="changeQty(this, -1)">-</button>
    <span>0</span>
    <button onclick="changeQty(this, 1)">+</button>
  </div>
  <button onclick="addQtyToCart('×§×•×œ×” ×–×™×¨×• 1.5 ×œ×™×˜×¨', 14, this)">×”×•×¡×£ ×œ×¢×’×œ×”</button>
  <p style="color:red; font-weight:bold; margin-top:5px;">××œ ×ª×©×›×—/×™ ×œ×”×•×¡×™×£ ×œ×¢×’×œ×”</p>
</div>

<div class="drink-container" dir="rtl">
  <label>××™× 1.5 ×œ×™×˜×¨ - â‚ª14</label>
  <div class="qty-control">
    <button onclick="changeQty(this, -1)">-</button>
    <span>0</span>
    <button onclick="changeQty(this, 1)">+</button>
  </div>
  <button onclick="addQtyToCart('××™× 1.5 ×œ×™×˜×¨', 14, this)">×”×•×¡×£ ×œ×¢×’×œ×”</button>
  <p style="color:red; font-weight:bold; margin-top:5px;">××œ ×ª×©×›×—/×™ ×œ×”×•×¡×™×£ ×œ×¢×’×œ×”</p>
</div>

<div class="drink-container" dir="rtl">
  <label>×§×•×§×” ×§×•×œ×” - â‚ª7</label>
  <div class="qty-control">
    <button onclick="changeQty(this, -1)">-</button>
    <span>0</span>
    <button onclick="changeQty(this, 1)">+</button>
  </div>
  <button onclick="addQtyToCart('×§×•×§×” ×§×•×œ×”', 7, this)">×”×•×¡×£ ×œ×¢×’×œ×”</button>
  <p style="color:red; font-weight:bold; margin-top:5px;">××œ ×ª×©×›×—/×™ ×œ×”×•×¡×™×£ ×œ×¢×’×œ×”</p>
</div>

<div class="drink-container" dir="rtl">
  <label>×§×•×œ×” ×–×™×¨×• - â‚ª7</label>
  <div class="qty-control">
    <button onclick="changeQty(this, -1)">-</button>
    <span>0</span>
    <button onclick="changeQty(this, 1)">+</button>
  </div>
  <button onclick="addQtyToCart('×§×•×œ×” ×–×™×¨×•', 7, this)">×”×•×¡×£ ×œ×¢×’×œ×”</button>
  <p style="color:red; font-weight:bold; margin-top:5px;">××œ ×ª×©×›×—/×™ ×œ×”×•×¡×™×£ ×œ×¢×’×œ×”</p>
</div>

<div class="drink-container" dir="rtl">
  <label>××™× - â‚ª7</label>
  <div class="qty-control">
    <button onclick="changeQty(this, -1)">-</button>
    <span>0</span>
    <button onclick="changeQty(this, 1)">+</button>
  </div>
  <button onclick="addQtyToCart('××™×', 7, this)">×”×•×¡×£ ×œ×¢×’×œ×”</button>
  <p style="color:red; font-weight:bold; margin-top:5px;">××œ ×ª×©×›×—/×™ ×œ×”×•×¡×™×£ ×œ×¢×’×œ×”</p>
</div>

<div class="drink-container" dir="rtl">
  <label>×¡×•×“×” - â‚ª7</label>
  <div class="qty-control">
    <button onclick="changeQty(this, -1)">-</button>
    <span>0</span>
    <button onclick="changeQty(this, 1)">+</button>
  </div>
  <button onclick="addQtyToCart('×¡×•×“×”', 7, this)">×”×•×¡×£ ×œ×¢×’×œ×”</button>
  <p style="color:red; font-weight:bold; margin-top:5px;">××œ ×ª×©×›×—/×™ ×œ×”×•×¡×™×£ ×œ×¢×’×œ×”</p>
</div>




<script>
function changeQty(btn, delta){
  const span = btn.parentElement.querySelector('span');
  let qty = parseInt(span.textContent);
  qty += delta;
  if(qty < 0) qty = 0;
  span.textContent = qty;
}

function addToCart(btn, price, name){
  const parent = btn.parentElement;
  const toppings = [...parent.querySelectorAll('.topping:checked')].map(t=>t.dataset.name);
  const toppingsPrice = [...parent.querySelectorAll('.topping:checked')].reduce((sum,t)=>sum + parseInt(t.dataset.price || 0),0);
  parent.querySelectorAll('.topping:checked').forEach(t=> t.checked = false);
  cart.push({ name, price, toppings, toppingsPrice, type:"food" });
  updateCart();
  showAddedPopup();
}

function showAddedPopup(){ 
    const p = document.getElementById("addedPopup"); 
    p.classList.add("show"); 
    setTimeout(() => p.classList.remove("show"), 800);
}

</script>

<div id="cartToggle" onclick="toggleCart()">×”×¢×’×œ×” ×©×œ×™ ğŸ›’</div>

<div id="cart" class="cart">
  <div class="cart-header">
    <span>×¢×’×œ×ª ×”×§× ×™×•×ª ×©×œ×™</span>
    <button onclick="toggleCart()">X</button>
  </div>
  <div id="cartContent" class="cart-content">×”×¢×’×œ×” ×¨×™×§×”</div>
  <div id="cartFooter" class="cart-footer" style="display:none;"></div>
</div>

<div id="orderMessage">
  ×”×”×–×× ×” × ×©×œ×—×” ×‘×”×¦×œ×—×”!<br>
  ×× × ×—×–×¨×• ×œ-WhatsApp ×›×“×™ ×œ××©×¨ ××ª ×”×”×–×× ×”.
  <br><br>
  <a id="whatsappKitchen" target="_blank">
    <button>×“×‘×¨ ×¢× ×”××˜×‘×— ×”×™×©×¨××œ×™</button>
  </a>
</div>

<script>
  window.addEventListener("DOMContentLoaded", () => {
  const nameInput = document.getElementById("customerName");
  const surnameInput = document.getElementById("customerSurname");

  if (nameInput) {
    const savedName = sessionStorage.getItem("customerName");
    if (savedName) nameInput.value = savedName;

    nameInput.addEventListener("input", () => {
      sessionStorage.setItem("customerName", nameInput.value);
    });
  }

  if (surnameInput) {
    const savedSurname = sessionStorage.getItem("customerSurname");
    if (savedSurname) surnameInput.value = savedSurname;

    surnameInput.addEventListener("input", () => {
      sessionStorage.setItem("customerSurname", surnameInput.value);
    });
  }
});


let cart = JSON.parse(sessionStorage.getItem('sharedCart') || '[]');

window.addEventListener("load", () => {
  checkShabat();

  const savedItems = localStorage.getItem('tempCart');
  if (savedItems) {
    const newItems = JSON.parse(savedItems);
    cart = [...cart, ...newItems];
    localStorage.removeItem('tempCart');
  }

  updateCart();
});


function updateCart(){
  const cartContentDiv = document.getElementById("cartContent");
  const cartFooterDiv = document.getElementById("cartFooter");
  
  sessionStorage.setItem('sharedCart', JSON.stringify(cart));

  if(cart.length === 0){
    cartContentDiv.innerHTML = "×”×¢×’×œ×” ×¨×™×§×”";
    cartFooterDiv.style.display = "none";
    return;
  }
  
  let contentHtml = "";
  cart.forEach((item, index) => {
    const extra = item.toppings && item.toppings.length ? ` (${item.toppings.join(", ")})` : "";
    const itemQty = item.qty || 1; // Usa qty para garantir consistÃªncia
    const itemTotal = (item.price + (item.toppingsPrice || 0)) * itemQty;

    contentHtml += `
      <div class="cart-item" style="margin-bottom: 8px; border-bottom: 1px solid #eee; padding-bottom: 4px;">
        <button onclick="removeFromCart(${index})">X</button> 
        <strong>${itemQty}x</strong> ${item.name}${extra} â€” â‚ª${itemTotal.toFixed(2)}
      </div>`;
  });

  // CÃ¡lculo do Total Geral corrigido
  const total = cart.reduce((sum, item) => {
    const q = item.qty || 1;
    return sum + ((item.price + (item.toppingsPrice || 0)) * q);
  }, 0);

  cartContentDiv.innerHTML = contentHtml;
  cartFooterDiv.style.display = "block";
  cartFooterDiv.innerHTML = `
    <div style="font-size: 1.5em; font-weight: bold; margin-bottom: 10px;">×¡×”"×›: â‚ª${total.toFixed(2)}</div>
    <button style="width:100%; background-color: #28a745; color: white;" onclick="sendOrder()">×©×œ×— ×”×–×× ×”</button>`;
}

function removeFromCart(idx){
  cart.splice(idx,1);
  updateCart();
}

function toggleCart(){ document.getElementById('cart').classList.toggle('open'); }
function closeAndHideCart() {
  const cartEl = document.getElementById('cart');
  const toggleBtn = document.getElementById('cartToggle');

  cartEl.classList.remove('open'); // fecha o carrinho
  toggleBtn.style.display = 'none'; // esconde o botÃ£o da cart
}


async function sendOrder(){
  const name = document.getElementById('customerName').value.trim();
  const surname = document.getElementById('customerSurname').value.trim();
  
  if(!name || !surname){ alert("×× × ×”×›× ×¡ ×©× ×•×©× ××©×¤×—×”"); return; }
  if(cart.length < 1){ alert("×™×© ×œ×‘×—×•×¨ ×œ×¤×—×•×ª ×× ×” ××—×ª"); return; }

  const total = cart.reduce((sum, i) => {
    const q = i.qty || 1;
    return sum + ((i.price + (i.toppingsPrice || 0)) * q);
  }, 0);

  if (total < 120) { alert("âŒ ×¡×›×•× ×”×–×× ×” ××™× ×™××œ×™ ×”×•× â‚ª120"); return; }

  const order = { 
    name, 
    surname, 
    items: cart.filter(i => i.type === 'food'), 
    drinks: cart.filter(i => i.type === 'drink' || i.type === 'qty'),
    total 
  };

  try {
    const response = await fetch("/orders", { 
      method: "POST", 
      headers: { "Content-Type": "application/json" }, 
      body: JSON.stringify(order) 
    });
    
    if(response.ok) {
        cart = []; 
        sessionStorage.removeItem('sharedCart');
        updateCart();

        closeAndHideCart(); // ğŸ‘ˆ SÃ“ ISSO FOI ADICIONADO

        document.getElementById('orderMessage').style.display = 'flex';
        updateWhatsAppLink(name, surname);
    } else {
        alert("Erro no servidor ao enviar pedido.");
    }
  } catch(err){ 
      alert("×©×’×™××” ×‘×©×œ×™×—×ª ×”×”×–×× ×”"); 
  }
}


function updateWhatsAppLink(name, surname) {
  const message = "×©×œ×•×, ×©×œ×—×ª×™ ×œ×›× ×”×–×× ×” ×©×œ ××•×›×œ ×¢×œ ×©×: " + name + " " + surname;
  const url = "https://wa.me/972559508114?text=" + encodeURIComponent(message);
  document.getElementById("whatsappKitchen").href = url;
}

document.querySelectorAll('.latin-only').forEach(input => {
  input.addEventListener('input', () => { input.value = input.value.replace(/[^a-zA-Z\s]/g, ''); });
});

function addQtyToCart(name, price, btn) {
    const container = btn.parentElement;
    const qtySpan = container.querySelector('span');
    let qty = parseInt(qtySpan.textContent);
    if (qty < 1) { alert("×‘×—×¨ ×œ×¤×—×•×ª 1 ×¤×¨×™×˜"); return; }

    // CORREÃ‡ÃƒO AQUI:
    cart.push({
        name: name,
        price: price, // Mande o preÃ§o UNITÃRIO (o servidor ou o total cuidam do resto)
        toppings: [],
        toppingsPrice: 0,
        type: "drink",
        qty: qty      // Mudado de 'quantity' para 'qty' para bater com o servidor
    });

    qtySpan.textContent = 0; // reseta quantidade no visor
    updateCart();
    showAddedPopup();
}

function changeQty(btn, delta) {
    const span = btn.parentElement.querySelector('span');
    let qty = parseInt(span.textContent);
    qty += delta;
    if (qty < 0) qty = 0;
    span.textContent = qty;
}

</script>

</body>
</html>